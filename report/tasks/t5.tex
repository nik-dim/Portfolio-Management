\section{Question 5}  
\textbf{Compute additional metrics for the assets such as the correlation and covariance matrices, for the entire and two subperiods (of your own choosing), if needed. Interpret your findings. Also, compute each fundâ€™s alpha, beta, R-square. Interpret your findings from the perspective of the investor}

\subsection{Covariance and Correlation}
Let \( X \) and \( Y \) be two random variables. Then the covariance is a measure of the joint variability of these two random variables:

\begin{equation}
    \label{eq:covariance}
    cov(X,Y) = \mathbb{E}[(X-\bar{x})(Y-\bar{y})] 
\end{equation}
In our case these random variables are the daily returns of the various instruments. The element \( (i,j) \) of the covariance matrix is the covariance between instruments \( i \) and \( j \), as presented below (in percentage values):

\begin{center}
    \begin{adjustwidth}{\adjust}{}
	\begin{tabular}{l|rrrrrrrrrrr}
	\toprule
	{} &     AVGO &      NOW &     TSLA &     AMZN &     IRDM &       BR &    PYACX &    SIGAX &     gold &  palladium &  S\&P 500 \\
	\midrule
	AVGO      &  0.04166 &  0.01663 &  0.01737 &  0.01309 &  0.01260 &  0.00864 & -0.00085 & -0.00028 & -0.00168 &    0.00511 &  0.00966 \\
	NOW       &  0.01663 &  0.04958 &  0.01884 &  0.01871 &  0.01682 &  0.01191 & -0.00057 &  0.00004 & -0.00176 &    0.00490 &  0.01047 \\
	TSLA      &  0.01737 &  0.01884 &  0.08127 &  0.01615 &  0.01173 &  0.00837 & -0.00072 & -0.00017 & -0.00200 &    0.00543 &  0.00903 \\
	AMZN      &  0.01309 &  0.01871 &  0.01615 &  0.03415 &  0.01633 &  0.00977 & -0.00040 & -0.00009 & -0.00113 &    0.00364 &  0.00944 \\
	IRDM      &  0.01260 &  0.01682 &  0.01173 &  0.01633 &  0.06936 &  0.00968 & -0.00114 & -0.00047 & -0.00110 &    0.00535 &  0.01012 \\
	BR        &  0.00864 &  0.01191 &  0.00837 &  0.00977 &  0.00968 &  0.01607 & -0.00036 & -0.00012 & -0.00104 &    0.00291 &  0.00657 \\
	PYACX     & -0.00085 & -0.00057 & -0.00072 & -0.00040 & -0.00114 & -0.00036 &  0.00071 &  0.00051 &  0.00072 &   -0.00002 & -0.00048 \\
	SIGAX     & -0.00028 &  0.00004 & -0.00017 & -0.00009 & -0.00047 & -0.00012 &  0.00051 &  0.00052 &  0.00052 &    0.00021 & -0.00014 \\
	gold      & -0.00168 & -0.00176 & -0.00200 & -0.00113 & -0.00110 & -0.00104 &  0.00072 &  0.00052 &  0.00976 &    0.00377 & -0.00108 \\
	palladium &  0.00511 &  0.00490 &  0.00543 &  0.00364 &  0.00535 &  0.00291 & -0.00002 &  0.00021 &  0.00377 &    0.02920 &  0.00338 \\
	S\&P 500   &  0.00966 &  0.01047 &  0.00903 &  0.00944 &  0.01012 &  0.00657 & -0.00048 & -0.00014 & -0.00108 &    0.00338 &  0.00714 \\
	\bottomrule
	\end{tabular}
    \end{adjustwidth}
\end{center}


The correlation is the normalization of the covariance.
\begin{equation}
    \label{eq:correlation}
    \rho_{X,Y}=\frac{cov(X,Y)}{\sigma_X \cdot\sigma_Y}
\end{equation}
The correlation ranges between \( -1 \) and \( 1 \) and it measures the linear dependence between two variables. 
\begin{equation}
    \rho_{X,Y}\begin{cases}
        =-1, & \text{perfect decreasing (inverse) linear relationship}\\
        \in (-1,1), & \text{indicating the degree of linear dependence between the variables}\\
        =1, & \text{perfect (increasing) linear  relationship}
     \end{cases}
\end{equation}

The correlation matrix is presented below:
\begin{center}
    \begin{adjustwidth}{\adjust}{}
	\begin{tabular}{l|rrrrrrrrrrr}
	\toprule
	{} &     AVGO &      NOW &     TSLA &     AMZN &     IRDM &       BR &    PYACX &    SIGAX &     gold &  palladium &  S\&P 500 \\
	\midrule
	AVGO      &  1.00000 &  0.36602 &  0.29851 &  0.34694 &  0.23444 &  0.33376 & -0.15515 & -0.05926 & -0.08318 &    0.14655 &  0.56030 \\
	NOW       &  0.36602 &  1.00000 &  0.29685 &  0.45479 &  0.28687 &  0.42206 & -0.09508 &  0.00769 & -0.08010 &    0.12879 &  0.55637 \\
	TSLA      &  0.29851 &  0.29685 &  1.00000 &  0.30646 &  0.15619 &  0.23173 & -0.09462 & -0.02675 & -0.07085 &    0.11149 &  0.37479 \\
	AMZN      &  0.34694 &  0.45479 &  0.30646 &  1.00000 &  0.33547 &  0.41702 & -0.08134 & -0.02104 & -0.06178 &    0.11528 &  0.60447 \\
	IRDM      &  0.23444 &  0.28687 &  0.15619 &  0.33547 &  1.00000 &  0.28986 & -0.16254 & -0.07767 & -0.04224 &    0.11885 &  0.45495 \\
	BR        &  0.33376 &  0.42206 &  0.23173 &  0.41702 &  0.28986 &  1.00000 & -0.10708 & -0.04245 & -0.08267 &    0.13438 &  0.61364 \\
	PYACX     & -0.15515 & -0.09508 & -0.09462 & -0.08134 & -0.16254 & -0.10708 &  1.00000 &  0.84259 &  0.27093 &   -0.00480 & -0.21479 \\
	SIGAX     & -0.05926 &  0.00769 & -0.02675 & -0.02104 & -0.07767 & -0.04245 &  0.84259 &  1.00000 &  0.23236 &    0.05408 & -0.07076 \\
	gold      & -0.08318 & -0.08010 & -0.07085 & -0.06178 & -0.04224 & -0.08267 &  0.27093 &  0.23236 &  1.00000 &    0.22312 & -0.12976 \\
	palladium &  0.14655 &  0.12879 &  0.11149 &  0.11528 &  0.11885 &  0.13438 & -0.00480 &  0.05408 &  0.22312 &    1.00000 &  0.23437 \\
	S\&P 500   &  0.56030 &  0.55637 &  0.37479 &  0.60447 &  0.45495 &  0.61364 & -0.21479 & -0.07076 & -0.12976 &    0.23437 &  1.00000 \\
	\bottomrule
	\end{tabular}
    \end{adjustwidth}
\end{center}
Both correlation and covariance matrices are symmetric.

The correlation matrix is also shown in Figure \ref{fig:correlation matrix}. In Figure \ref{fig:pairplot} another visualization of the effect of correlation coefficients is presented.
\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{media/Correlation_Matrix.png}
    \caption{The correlation matrix for our instruments.}
    \label{fig:correlation matrix}
\end{figure}

The correlation coefficient is a powerful tool for investors. It is a measure of strength of the linear relationship between price movements of two individual securities and hence can be used to gain diversification benefits. Two negatively correlated securities have less risk (in terms of volatility), compared to two positively correlated ones. Therefore investors can reduce the overall risk due to price fluctuations, by including negatively correlated assets in their portfolio.

We can observe from Figure \ref{fig:correlation matrix} that the inclusion of both bonds and commodities in our portfolio indeed provides risk diversification, as they present either very low or negative correlation values with stock securities. Additionally the choice of stocks of different company sizes and sectors also offers diversification benefits, since the correlation of their prices is relatively weak (below 0.5).

\begin{figure}[H]
    \centering
    \includegraphics[width=\linewidth]{media/Pair_Plot.png}
    \captionsetup{width=.7\linewidth}
    \caption{An illustration of the correlation matrix. When the correlation coefficient is negative the slope of the regression line is negative.}
    \label{fig:pairplot}
\end{figure}


\subsection{Beta}  
The beta coefficient measures the systematic risk of an individual stock compared to risk of the entire market. The beta formula is:

\begin{equation}
    \label{eq:beta}
    \beta = \frac{\text{cov}(R_e,R_m)}{\text{var}(R_m)}
\end{equation}

where \( R_e \) is the return of the individual stock and \( R_m \) is the return of the overall market. In order to calculate \( \beta \), a regression model has to be fitted 
on the data points from an individual stock's returns against those of the market. Then \( \beta \) is the slope of the aforementioned line.

Even though the formula is straightforward, the data selection is not. The result depends on the time frame and frequency of historical data selected. Hence, many different \( \beta \) values can be found online. We use daily returns of the last 5 years as our data. To be more specific, let \( \mathcal{ D } =\left\{d_0,d_1,\dots,d_{n}\right\} \) be the closing prices of the individual stock. Then, \( \mathcal{ P } = \left\{p_1,\dots,p_{n}\right\} \)  is the set of the percent changes of said closing prices where \( p_i = \frac{d_i-d_{i-1}}{d_{i-1}}\times 100\% \). Note that \( \mathcal{ P } = R_e \) (see \eqref{eq:beta}). By the same token, \( R_m \) is calculated using the historical closing prices of the market index (\texttt{S\&P 500}), as it is widely considered as an index for representation of the entire market. Using these data points and equation \eqref{eq:beta}, \( \beta \) is calculated.

Beta coefficient helps investors to understand how volatile or risky a security is compared to the market. If \( \beta \) has a value of 1.0, then the security is as volatile as the market and it does not add any risk to the portfolio, but also does not increase the potential excess returns. If \( \beta \) has a value of 1.3, then the security is assumed to have 30\% more volatility compared to the market. If the market goes up by 10\%, then the security will go up by 13\%, and vice versa. Therefore an investor can use \( \beta \) to theoretically deduct how much risk a security will add to a diversified portfolio. However in order for \( \beta \) to have a meaningful value, a high R-squared value is required between the security and the benchmark used in calculations.

\subsection{Alpha} 
By finding \( \beta \) we can proceed to calculate \( \alpha \). To be more precise \( \alpha \) denotes the excess return. The Capital Asset Pricing Model (CAPM) is given by:
\begin{equation}
    \label{eq:CAPM}
    \mathbb{E}  (R_{i})=R_{f}+\beta _{{i}}(\mathbb{E}  (R_{m})-R_{f}) 
\end{equation}
where \( \mathbb{E}  (R_{i}) \) is the expected return of the individual asset and \( R_f \) is the risk-free rate. Then, \( \alpha \) is calculated by subtracting the expected returns from the actual mean portfolio returns \( \bar{R} \):
\begin{equation}
    \label{eq:alpha}
    \alpha = \bar{R} - \mathbb{E} (R) 
\end{equation}

The \( \alpha \) coefficient can be directly calculate from the linear regression model between the security's returns and those of the market. \( \alpha \) is used from investors to determine whether or not a security has exceeded expectations in term of returns. Positive values of \( \alpha \) indicate that the security is underpriced, whereas negative values indicate an overvalued security. An \( \alpha \) value of 0 denotes that a security is fairly priced.

\subsection{R-squared} 
\( R \)-squared or coefficient of variation is calculated using the following formula:
\begin{equation}
    \label{eq:r-squared}
    R^2=1-\frac{\text{Explained Variation}}{\text{Total Variation}}
\end{equation}

\( R^2 \) is a statistical measure that indicates the proportion of the variation of a dependent variable that can be explained using the independent variables of a simple regression model. An illustrative explanation is adduced using the following figures. In Figure \ref{fig:rsquared_explanation_regression} a simple regression model is fitted using the data provided. The explained variation is the sum of squared distances from the regression line divided by the number of points. Said distances are denoted with a blue colour. The total variation is calculated by the same token but with a crucial difference: the line is horizontal and denotes the mean of the data, as illustrated in Figure \ref{fig:rsquared_explanation_total}.

\begin{figure*}[!t]
    \centering
    \begin{subfigure}[t]{0.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{media/regression_line.png}
        \caption{Explained Variation}
        \label{fig:rsquared_explanation_regression}
    \end{subfigure}%
    ~ 
    \begin{subfigure}[t]{0.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{media/mean_line.png}
        \label{fig:q2}
        \caption{Total Variation}
        \label{fig:rsquared_explanation_total}
    \end{subfigure}
    \caption{\( R \)-squared calculation}
\end{figure*}

In investments, the \( R^2 \) measure denotes the percentage of a security's price movements that can be explained by movements of the benchmark index. \( R^2 \) essentially measures the correlation between an asset's price changes and that of the benchmark. It is also used as statistical technique to asses the trustworthiness of a \( beta \) coefficient. High \( R^2 \) values (above 0.7) indicate a more useful \( \beta \) figure.

\subsection{Sharpe Ratio} 
The Sharpe ratio is named after Nobel Laureate William Sharpe. It is a measure that relates the return of an investment to its risk; it is the risk-adjusted return. 
\begin{equation}
    \label{eq:sharpe ratio}
    \text{Sharpe Ratio} = \frac{R_p-R_f}{\sigma_p}    
\end{equation}

\vspace{\baselineskip}
where
\begin{itemize}
    \item \( R_p=\text{Return of a portfolio} \)
    \item \( R_f=\text{Risk-free rate} \)
    \item \( \sigma_p=\text{standard variation of the portfolio's excess return} \)
\end{itemize}

\paragraph*{Risk-free rate} The \textit{trailing} 5 year average (daily interval) of the 10-Year Treasury Constant Maturity Rate is used as the Risk-free rate.

\paragraph*{Methodology}
Since we are working with daily data, the following methodology is used to calculate annualized return and standard deviation of a security or portfolio:

\begin{itemize}
	\item From daily prices, calculate the daily returns \( p_i = \frac{d_i-d_{i-1}}{d_{i-1}}\)
	\item Calculate the mean \( \bar{p}_{daily} \) and standard deviation \( \sigma_{daily} \).
	\item The annualized return is given from the following equation:
	\begin{equation}
	\label{eq:annualized_return}
	\text{Annualized Return (\%)} =  [(1+\bar{p}_{daily})^{252}-1] * 100
	\end{equation}
	\item The annualized standard deviation is given from the following equation:
	\begin{equation}
	\label{eq:annualized_std}
	\text{Annualized Standard Deviation (\%)} =  \sigma_{daily} * \sqrt{252} * 100
	\end{equation}
\end{itemize}

The value 252 represents the total number of trading days that occur within a 1-year period.

Using the historical data for each asset and the analysis presented above, we calculate \( \alpha, \beta\) and the \( R^2 \) using \texttt{Python}. The results are presented below:

\begin{center}
    \begin{adjustwidth}{}{}
    	\begin{tabular}{l|rrrrrrrrrr}
    		\toprule
    		{} &     AVGO &      NOW &     TSLA &     AMZN &     IRDM &       BR &    PYACX &    SIGAX &     gold &  palladium \\
    		\midrule
    		alpha     &  0.14213 &  0.24718 &  0.17711 &  0.32815 &  0.15867 &  0.13206 & -0.00576 & -0.01215 &  0.05087 &    0.17817 \\
    		beta      &  1.35333 &  1.46614 &  1.26445 &  1.32199 &  1.41795 &  0.92064 & -0.06792 & -0.01911 & -0.15174 &    0.47398 \\
    		R-squared &  0.31393 &  0.30955 &  0.14046 &  0.36539 &  0.20698 &  0.37655 &  0.04613 &  0.00501 &  0.01684 &    0.05493 \\
    		\bottomrule
    	\end{tabular}
    \end{adjustwidth}
\end{center}